'use strict';mix_d("CerberusSharedCards__cerberus-shared:cerberus-shared__p6OxqZVU","require exports tslib @p/A @c/metrics @c/aui-truncate @c/aui-utils @c/logger @c/pagemarker @c/remote-operations @c/scoped-dom @c/tracking @c/aui-feature-detect".split(" "),function(da,M,y,qa,U,ra,sa,v,ta,ua,va,N,wa){function H(a){return a&&"object"===typeof a&&"default"in a?a:{"default":a}}function ea(a){if(a&&a.__esModule)return a;var d=Object.create(null);a&&Object.keys(a).forEach(function(b){if("default"!==b){var c=
Object.getOwnPropertyDescriptor(a,b);Object.defineProperty(d,b,c.get?c:{enumerable:!0,get:function(){return a[b]}})}});d["default"]=a;return d}var E=H(qa),f=H(U),xa=H(ra),ya=H(sa),fa=H(ta),za=H(ua),I=H(va),Aa=H(wa),ha={},V=function(a,d,b){void 0===d&&(d="");void 0===b&&(b=1);d=a+d;ha.hasOwnProperty(d)||(ha[d]=!0,U.count(a,(U.count(a)||0)+b))},Ba=function(a){V(E["default"].capabilities.mobile?"Card:EERU:SharedLib:mobile:render":"Card:EERU:SharedLib:desktop:render");var d=function(c,e){c={$event:{preventDefault:E["default"].$.noop,
stopPropagation:E["default"].$.noop},$target:c.getContent().find('[data-a-tab-name="'+e+'"]'),data:{name:"energyEfficiencyTabSet"}};E["default"].trigger("a:declarative:a-tabs:click",c)},b=function(c,e){var g=c&&c.$event,l=c&&c.data||{},m=l.activeTabName,n=l.modalHeight,q=l.name;g&&g.preventDefault&&g.preventDefault();g&&g.stopPropagation&&g.stopPropagation();g=e.get(q);g||(E["default"].on("a:popover:beforeShow:"+q,function(k){k.popover&&k.popover.getContent&&(k=k.popover.getContent(),k.find(".a-manually-loaded").parent().css("min-height",
n),E["default"].loadDescendantImagesManually(k))}),g=e.create(c.$target,l));g.show();d(g,m)};a.when("a-secondary-view").execute("RegisterEnergyEfficiencyEventMobile",function(c){E["default"].declarative("card-energy-efficiency-secondary-view","click",function(e){V("Card:EERU:SharedLib:mobile:click",e&&e.data&&e.data.name||"");b(e,c)})});a.when("a-modal").execute("RegisterEnergyEfficiencyEventDesktop",function(c){E["default"].declarative("card-energy-efficiency-modal","click",function(e){V("Card:EERU:SharedLib:desktop:click",
e&&e.data&&e.data.name||"");b(e,c)})})},Ca=function(a){a.when("ready").execute("EEBadgeProductFicheResize",function(d){var b=E["default"].$;b(".energyEfficiencyContainer").each(function(c,e){c=b(e).find(".energyEfficiencyProductFicheLabel").first();e=b(e).find("svg").first();c.parent().outerHeight()>e.outerHeight()&&(c.removeClass("a-size-small"),c.addClass("a-size-micro"),c.parent().outerHeight()>e.outerHeight()&&c.parent().css("line-height","10px"))})})},Da=function(){var a=window.P;Ba(a);Ca(a)},
S={wb:1},Ea=function(a){return{subsAsin:a.asin,subsAvgRating:a.reviewRating,subsCurrency:a.currencyCode,subsHighestPrice:parseFloat(a.priceRangeHigh||"")||void 0,subsIsParent:a.isParent,subsIsPrime:a.isPrime,subsIsPrimeBadgeLazy:a.isPrimeBadgeLazyEnabled,subsLowestPrice:parseFloat(a.priceRangeLow||"")||void 0,subsPosition:a.position-1,subsPrice:parseFloat(a.price||"")||0,subsPrimeEligible:a.isPrime,subsSourcesMap:a.substituteSourcesMap,subsTotalReviews:a.reviewCount,subsSource:null,subsSourceScore:null}},
Fa=function(){f["default"].count("rsi.crb.dpmark.reg.auical",1);P.now("injectCalendarOnDetailPage").execute("cerberusSharedCardsAuiCalendarRegisterDpMarker",function(a){if(!a)try{P.register("injectCalendarOnDetailPage",function(){var d;return d={},d.injectCalendarOnDetailPage=1,d})}catch(d){}})},W=function(a,d,b){d=encodeURIComponent(d);a.classList.add("a-declarative");a.setAttribute("data-action",d);a.setAttribute("data-"+d.toLowerCase(),JSON.stringify(b))},ia=function(a,d,b){d=encodeURIComponent(d);
a.setAttribute("data-"+d.toLowerCase(),JSON.stringify(b))},ja=function(a,d){return{asin:d,buyingRuleId:a,existingRuleRedirectView:"delete",existingRuleTerminatedRedirectView:"edit",minFormActions:"true",noRuleRedirectToCreateAsin:d,source:"dpoosw"}},ka=function(a,d){return{asin:d,buyingRuleId:a,existingRuleRedirectView:"delete",existingRuleTerminatedRedirectView:"edit",minFormActions:"true",noRuleRedirectToCreateAsin:d,source:"dpoosw"}},Ga=function(){f["default"].count("rsi.crb.dpmark.reg.brdp",1);
P.now("useBuyingRulesDpAssets").execute("cerberusSharedCardsBuyingRulesCxRegisterDpMarker",function(a){if(!a)try{P.register("useBuyingRulesDpAssets",function(){return{useBuyingRulesDpAssets:1}})}catch(d){}})},Ha=function(a){f["default"].count("rsi.crb.brx.setup.pending",1);P.when("brx-dp-app-behavior").execute("cerberusSharedCardsBuyingRulesCx",function(d){f["default"].count("rsi.crb.brx.setup.start",1);var b=d.eventNames,c=d.viewNames,e=a.pageAsin;if(e){var g=I["default"].cardRoot.getElementsByClassName("_Y2VyY_idWidgetSubTitle_2fmXg")[0];
if(g){var l=I["default"].cardRoot.getElementsByClassName("_Y2VyY_idBuyingRuleSubTitleCreate_RX7tg")[0],m=I["default"].cardRoot.getElementsByClassName("_Y2VyY_idBuyingRuleSubTitleDelete_1jzas")[0],n=I["default"].cardRoot.getElementsByClassName("_Y2VyY_idBuyingRuleSubTitleEdit_aFklQ")[0];if(l&&m&&n){l=l.getElementsByTagName("a")[0];var q=m.getElementsByTagName("a")[0],k=n.getElementsByTagName("a")[0];if(l&&q&&k){var r=function(h){h===c.CREATE_BUYING_RULE_VIEW_NAME?g.setAttribute("data-buyingruleaction",
"create"):h===c.DELETE_BUYING_RULE_VIEW_NAME?g.setAttribute("data-buyingruleaction","delete"):h===c.EDIT_BUYING_RULE_VIEW_NAME&&g.setAttribute("data-buyingruleaction","edit")};m=d.localizedDataManager;m.setLocale(a.language,a.currency);n=a.localizedStrings;"object"===typeof n&&n?m.assignStrings(n):(v.log("CerberusSharedCards.BRX.Setup.strings not found in data attributes for asin("+e+")","ERROR"),f["default"].count("rsi.crb.brx.setup.nostrings",1));n=m.getString("create-buying-rule--a-modal--option--header");
var z={ajaxFailMsg:m.getString("create-buying-rule--view--load-failed--message"),closeMessage:m.getString("a-sheet--option--generic--closeMessage"),header:n,popoverLabel:n,sheetLabel:n};n=m.getString("delete-buying-rule--a-modal--option--header");var p={ajaxFailMsg:m.getString("delete-buying-rule--view--load-failed--message"),closeMessage:m.getString("a-sheet--option--generic--closeMessage"),header:n,popoverLabel:n,sheetLabel:n};n=m.getString("edit-buying-rule--a-modal--option--header");var x={ajaxFailMsg:m.getString("edit-buying-rule--view--load-failed--message"),
closeMessage:m.getString("a-sheet--option--generic--closeMessage"),header:n,popoverLabel:n,sheetLabel:n};d.addHook_SHOW_VIEW_BEFORE_SHOW_LOCALIZE_VIEW(c.CREATE_BUYING_RULE_VIEW_NAME,function(h){h.updateViewLanguage(c.CREATE_BUYING_RULE_VIEW_NAME,z);r(c.CREATE_BUYING_RULE_VIEW_NAME)});d.addHook_SHOW_VIEW_BEFORE_SHOW_LOCALIZE_VIEW(c.DELETE_BUYING_RULE_VIEW_NAME,function(h){h.updateViewLanguage(c.DELETE_BUYING_RULE_VIEW_NAME,p);r(c.DELETE_BUYING_RULE_VIEW_NAME)});d.addHook_SHOW_VIEW_BEFORE_SHOW_LOCALIZE_VIEW(c.EDIT_BUYING_RULE_VIEW_NAME,
function(h){h.updateViewLanguage(c.EDIT_BUYING_RULE_VIEW_NAME,x);r(c.EDIT_BUYING_RULE_VIEW_NAME)});d.addHook_SHOW_VIEW_REDIRECT_LOCALIZE_VIEW(c.CREATE_BUYING_RULE_VIEW_NAME,function(h,t,u,C){h.updateViewLanguage(c.CREATE_BUYING_RULE_VIEW_NAME,z);r(u)});d.addHook_SHOW_VIEW_REDIRECT_LOCALIZE_VIEW(c.DELETE_BUYING_RULE_VIEW_NAME,function(h,t,u,C){h.updateViewLanguage(c.DELETE_BUYING_RULE_VIEW_NAME,p);r(u)});d.addHook_SHOW_VIEW_REDIRECT_LOCALIZE_VIEW(c.EDIT_BUYING_RULE_VIEW_NAME,function(h,t,u,C){h.updateViewLanguage(c.EDIT_BUYING_RULE_VIEW_NAME,
x);r(u)});W(l,"brx-create-buying-rule-view",{buyingRuleId:a.buyingRuleId,asin:e,minFormActions:"true",existingRuleRedirectView:"delete",existingRuleTerminatedRedirectView:"edit",source:"dpoosw"});W(q,"brx-delete-buying-rule-view",ja(a.buyingRuleId,e));W(k,"brx-edit-buying-rule-view",ka(a.buyingRuleId,e));var w=!1;"create"===a.buyingRuleInitialAction?f["default"].count("rsi.crb.brx.initial.create.show",1):"delete"===a.buyingRuleInitialAction?f["default"].count("rsi.crb.brx.initial.delete.show",1):
"edit"===a.buyingRuleInitialAction&&f["default"].count("rsi.crb.brx.initial.edit.show",1);l.addEventListener("click",function(h){f["default"].count("rsi.crb.brx.create.click",1);w||"create"!==a.buyingRuleInitialAction||(w=!0,f["default"].count("rsi.crb.brx.initial.create.click",1))});q.addEventListener("click",function(h){f["default"].count("rsi.crb.brx.delete.click",1);w||"delete"!==a.buyingRuleInitialAction||(w=!0,f["default"].count("rsi.crb.brx.initial.delete.click",1))});k.addEventListener("click",
function(h){f["default"].count("rsi.crb.brx.edit.click",1);w||"edit"!==a.buyingRuleInitialAction||(w=!0,f["default"].count("rsi.crb.brx.initial.edit.click",1))});d.eventManager.subscribe([b.CREATE_BUYING_RULE_FORM_SEND_SUCCESS_EVENT,b.DEACTIVATE_BUYING_RULE_FORM_SEND_SUCCESS_EVENT,b.EDIT_BUYING_RULE_FORM_SEND_SUCCESS_EVENT],function(h,t){var u;if((null===(u=null===h||void 0===h?void 0:h.buyingRuleModel)||void 0===u?void 0:u.asin)===e){u=h.buyingRuleModel.id;h=h.buyingRuleModel.isTerminated;ia(q,"brx-delete-buying-rule-view",
ja(u,e));ia(k,"brx-edit-buying-rule-view",ka(u,e));var C=q.setAttribute;var D="/buying-rules?ref_="+encodeURIComponent("mobile"===a.deviceType?"rsi_br_brh_dpoosw_dbrl_mawd":"rsi_br_brh_dpoosw_dbrl_dstd")+"&action="+encodeURIComponent("delete-br")+"&source=dpoosw&buyingRuleId="+encodeURIComponent(u)+"&noRuleRedirectToCreateAsin="+encodeURIComponent(e||"")+"&existingRuleRedirectView=delete&existingRuleTerminatedRedirectView=edit&minFormActions=true";C.call(q,"href",D);C=k.setAttribute;u="/buying-rules?ref_="+
encodeURIComponent("mobile"===a.deviceType?"rsi_br_brh_dpoosw_ebrl_mawd":"rsi_br_brh_dpoosw_ebrl_dstd")+"&action="+encodeURIComponent("edit-br")+"&source=dpoosw&buyingRuleId="+encodeURIComponent(u)+"&noRuleRedirectToCreateAsin="+encodeURIComponent(e||"")+"&existingRuleRedirectView=delete&existingRuleTerminatedRedirectView=edit&minFormActions=true";C.call(k,"href",u);r(h?c.EDIT_BUYING_RULE_VIEW_NAME:c.DELETE_BUYING_RULE_VIEW_NAME);t===b.CREATE_BUYING_RULE_FORM_SEND_SUCCESS_EVENT?f["default"].count("rsi.crb.brx.create.complete",
1):(t===b.EDIT_BUYING_RULE_FORM_SEND_SUCCESS_EVENT||t===b.DEACTIVATE_BUYING_RULE_FORM_SEND_SUCCESS_EVENT)&&f["default"].count("rsi.crb.brx.edit.complete",1)}});d.eventManager.subscribe(b.DELETE_BUYING_RULE_FORM_SEND_SUCCESS_EVENT,function(h){var t;(null===(t=null===h||void 0===h?void 0:h.buyingRuleModel)||void 0===t?void 0:t.asin)===e&&(r(c.CREATE_BUYING_RULE_VIEW_NAME),f["default"].count("rsi.crb.brx.delete.complete",1))});f["default"].count("rsi.crb.brx.setup.end",1)}else v.log("CerberusSharedCards.BRX.Setup.create/delete/edit link element not found for asin("+
e+")","FATAL"),f["default"].count("rsi.crb.brx.setup.error",1)}else v.log("CerberusSharedCards.BRX.Setup.create/delete/edit sub title element not found for asin("+e+")","FATAL"),f["default"].count("rsi.crb.brx.setup.error",1)}else v.log("CerberusSharedCards.BRX.Setup.widget sub title element not found for asin("+e+")","FATAL"),f["default"].count("rsi.crb.brx.setup.error",1)}else v.log("CerberusSharedCards.BRX.Setup.page asin not found in data attributes","FATAL"),f["default"].count("rsi.crb.brx.setup.error",
1)})},Ia=function(a){return y.__awaiter(void 0,void 0,void 0,function(){var d,b;return y.__generator(this,function(c){switch(c.label){case 0:return Aa["default"].isSupported("isAmazonApp")?[4,new Promise(function(e,g){da(["@m/mash"],function(l){e(ea(l))},g)})]:[3,2];case 1:return d=c.sent(),d.cart.didUpdate({newCartQuantity:a}),[3,4];case 2:return[4,new Promise(function(e,g){da(["@p/nav.setCartCount"],function(l){e(ea(l))},g)})];case 3:b=c.sent(),b.default(a),c.label=4;case 4:return[2]}})})},X=function(a,
d,b,c){var e="none",g="none",l="none";"undefined"===typeof c?e="block":c?g="block":l="block";a&&(a.style.display=e);d&&(d.style.display=g);b&&(b.style.display=l)},Ja=function(a){var d={cssGlobalClassName:"cerberusSharedCards-deviceTypeUnknown",isDesktop:!1,isMobile:!1,isTablet:!1,isUnknown:!1,metrics:{counterSuffix:".unknown"},origType:a,type:"unknown"};"desktop"===a?(d.cssGlobalClassName="cerberusSharedCards-deviceTypeDesktop",d.isDesktop=!0,d.type="desktop",d.metrics.counterSuffix=".desktop"):"mobile"===
a?(d.cssGlobalClassName="cerberusSharedCards-deviceTypeMobile",d.isMobile=!0,d.type="mobile",d.metrics.counterSuffix=".mobile"):"tablet"===a?(d.cssGlobalClassName="cerberusSharedCards-deviceTypeTablet",d.isTablet=!0,d.type="tablet",d.metrics.counterSuffix=".tablet"):d.isUnknown=!0;return d},Ka=function(a){if("object"!==typeof a||!a)throw Error("ASIN faceout element is not valid");a=a.dataset;return{asin:a.asin||"",currencyCode:a.currencycode||"",hasPriceRange:"true"===a.haspricerange,isMapSuppressed:"true"===
a.ismapsuppressed,isParent:"true"===a.isparent,isPrime:"true"===a.isprime,isPrimeBadgeLazyEnabled:"true"===a.isprimebadgelazyenabled,offerListingId:a.offerlistingid,position:Number(a.position)||-1,price:a.price||"",priceRangeHigh:a.pricerangehigh,priceRangeLow:a.pricerangelow,reviewCount:Number(a.reviewcount)||0,reviewRating:parseFloat(a.reviewrating||"")||0,substituteSourcesMap:a.substitutesourcesmap}},La=function(a){if("object"!==typeof a||!a)throw Error("Widget data element is not valid");a=a.dataset;
var d=a.requestid,b=a.widgettype,c=a.widgettypevariant;if(!b||!d)throw Error("Required data attributes not found");return{buyingRuleId:a.buyingruleid,buyingRuleInitialAction:a.buyingruleinitialaction,currency:a.currency||"",customerId:a.customerid,deviceType:a.devicetype||"unknown",displayReason:a.displayreason||"UNKNOWN",isBuyingRuleTerminated:a.isbuyingruleterminated?"true"===a.isbuyingruleterminated:void 0,isBuyingRulesReminderCxEnabled:"true"===a.isbuyingrulesremindercxenabled,isLazyLoadedATCButtonEnabled:"true"===
a.islazyloadedatcbuttonenabled,isLazyPrimeBadgeEnabled:"true"===a.islazyprimebadgeenabled,language:a.language||"",localizedStrings:a.localizedstrings?JSON.parse(a.localizedstrings):{},marketplaceId:a.marketplaceid||"",pageAsin:a.pageasin,producerId:a.producerid,reftag:a.reftag||"",renderPageType:a.renderpagetype||"unknown",requestId:d,sessionId:a.sessionid||"",widgetType:b,widgetTypeVariant:c||"None"}},Ma=function(a,d,b){b={cssGlobalClassName:"cerberusSharedCards-widgetTypeUnknown",isCart:!1,isCompatibleProducts:!1,
isCoos:!1,isFlex:!1,isFod:!1,isGemini:!1,isLpo:!1,isLpoFreeSearchVariant:!1,isLpoShoppingAdsVariant:!1,isOos:!1,isOosGlanceViewVariant:!1,isUnknown:!1,metrics:{typeClientCounter:"prs.crb.clnt.env.wgt.unknown",typeServerCounter:"prs.crb.srv.env.wgt.unknown",typeVariantClientCounter:"prs.crb.clnt.env.wgt.var.none",typeVariantServerCounter:"prs.crb.srv.env.wgt.var.none"},origDisplayReason:b,type:a||"Unknown",typeVariant:"None"};"Cart"===a?(b.cssGlobalClassName="cerberusSharedCards-widgetTypeCart",b.isCart=
!0,b.metrics.typeClientCounter="prs.crb.clnt.env.wgt.cart",b.metrics.typeServerCounter="prs.crb.srv.env.wgt.cart"):"CompatibleProducts"===a?(b.cssGlobalClassName="cerberusSharedCards-widgetTypeCompatibleProducts",b.isCompatibleProducts=!0,b.metrics.typeClientCounter="prs.crb.clnt.env.wgt.compatible-products",b.metrics.typeServerCounter="prs.crb.srv.env.wgt.compatible-products"):"Coos"===a?(b.cssGlobalClassName="cerberusSharedCards-widgetTypeCoos",b.isCoos=!0,b.metrics.typeClientCounter="prs.crb.clnt.env.wgt.coos",
b.metrics.typeServerCounter="prs.crb.srv.env.wgt.coos"):"Flex"===a?(b.cssGlobalClassName="cerberusSharedCards-widgetTypeFlex",b.isFlex=!0,b.metrics.typeClientCounter="prs.crb.clnt.env.wgt.flex",b.metrics.typeServerCounter="prs.crb.srv.env.wgt.flex"):"Fod"===a?(b.cssGlobalClassName="cerberusSharedCards-widgetTypeFod",b.isFod=!0,b.metrics.typeClientCounter="prs.crb.clnt.env.wgt.fod",b.metrics.typeServerCounter="prs.crb.srv.env.wgt.fod"):"Gemini"===a?(b.cssGlobalClassName="cerberusSharedCards-widgetTypeGemini",
b.isGemini=!0,b.metrics.typeClientCounter="prs.crb.clnt.env.wgt.gemini",b.metrics.typeServerCounter="prs.crb.srv.env.wgt.gemini"):"Lpo"===a?(b.cssGlobalClassName="cerberusSharedCards-widgetTypeLpo",b.isLpo=!0,b.metrics.typeClientCounter="prs.crb.clnt.env.wgt.lpo",b.metrics.typeServerCounter="prs.crb.srv.env.wgt.lpo","LpoFreeSearch"===d?(b.isLpoFreeSearchVariant=!0,b.typeVariant=d,b.metrics.typeVariantClientCounter="prs.crb.clnt.env.wgt.var.lpo-free-search",b.metrics.typeVariantServerCounter="prs.crb.srv.env.wgt.var.lpo-free-search"):
"LpoShoppingAds"===d&&(b.isLpoShoppingAdsVariant=!0,b.typeVariant=d,b.metrics.typeVariantClientCounter="prs.crb.clnt.env.wgt.var.lpo-shopping-ads",b.metrics.typeVariantServerCounter="prs.crb.srv.env.wgt.var.lpo-shopping-ads")):"Oos"===a?(b.cssGlobalClassName="cerberusSharedCards-widgetTypeOos",b.isOos=!0,b.metrics.typeClientCounter="prs.crb.clnt.env.wgt.oos",b.metrics.typeServerCounter="prs.crb.srv.env.wgt.oos","OosGlanceView"===d&&(b.isOosGlanceViewVariant=!0,b.typeVariant=d,b.metrics.typeVariantClientCounter=
"prs.crb.clnt.env.wgt.var.oos-glance-view",b.metrics.typeVariantServerCounter="prs.crb.srv.env.wgt.var.oos-glance-view")):"Odp"===a?(b.cssGlobalClassName="cerberusSharedCards-widgetTypeOdp",b.metrics.typeClientCounter="prs.crb.clnt.env.wgt.odp",b.metrics.typeServerCounter="prs.crb.srv.env.wgt.odp"):(b.cssGlobalClassName="cerberusSharedCards-widgetTypeUnknown",b.isUnknown=!0,b.type="Unknown");return b},Na=function(a,d,b){var c,e=b.producerId;if(e){var g=b.customerId||null,l=b.marketplaceId,m=b.sessionId,
n=b.requestId,q={deviceType:b.deviceType,seedAsin:b.pageAsin,subsReason:b.displayReason};d=function(p){var x=p.imageLinkElement,w=p.titleLinkElement,h=Ea(p.dataAttributes);h=y.__assign(y.__assign({customerId:g,obfuscatedMarketplaceId:l,sessionId:m},q),h);f["default"].event(h,e,"prservices.SurfacedSubstituteEvent.6");var t=y.__assign({customerId:g,obfuscatedMarketplaceId:l,sessionId:m,subsAsin:p.asin,surfacedAsinRequestId:n},q);w?w.addEventListener("click",function(){f["default"].event(t,e,"prservices.ClickedSubstituteEvent.4")}):
v.log("CerberusSharedCards.MissingElement.titleLink not found; asin: "+p.asin,"ERROR");x?x.addEventListener("click",function(){f["default"].event(t,e,"prservices.ClickedSubstituteEvent.4")}):v.log("CerberusSharedCards.MissingElement.imageLink not found; asin: "+p.asin,"ERROR")};try{for(var k=y.__values(a),r=k.next();!r.done;r=k.next())d(r.value)}catch(p){var z={error:p}}finally{try{r&&!r.done&&(c=k.return)&&c.call(k)}finally{if(z)throw z.error;}}}else d.isCart||d.isLpo||v.log("CerberusSharedCards.NexusLogging.producerId not found",
"WARN")},Y=function(a,d,b,c,e){var g,l=d.reftag,m=b.isCart?"rsi.cart.":"rsi.oos.";f["default"].count(""+m+"atc.shown."+c,1);var n=-1;b=function(p){n++;var x=p.asin,w=p.dataAttributes.offerListingId;p=p.cartActionContainerElement;if(!p)return"continue";var h=l+"_oos_atcajx_"+c+"_"+n,t=l+"_oos_cartajx_"+c+"_"+n,u=p.querySelector("button");if(!u)return{value:void 0};if(!x||!w)return v.log("CerberusSharedCards.ATC.No offer listing ID to add to cart; asin: "+x+"; pageAsin: "+d.pageAsin),u.style.visibility=
"hidden","continue";var C=p.querySelector("._Y2VyY_afCartActionMessageLoading_NgVU3"),D=p.querySelector("._Y2VyY_afCartActionMessageSuccess_1Kidz"),J=p.querySelector("._Y2VyY_afCartActionMessageFail_2tBPW");u.addEventListener("click",function(){return y.__awaiter(void 0,void 0,void 0,function(){var F,K,L,O,G;return y.__generator(this,function(A){switch(A.label){case 0:f["default"].count(""+m+"atc.click."+c,1),X(C,D,J,void 0),A.label=1;case 1:return A.trys.push([1,3,,4]),F={asin:x,offerListingId:w},
[4,N.addTracking(e.addToCart,{},h||"")(F)];case 2:return A.sent(),[3,4];case 3:return K=A.sent(),v.log("CerberusSharedCards.ATC."+K.toString()+"; asin: "+x,"ERROR"),f["default"].count(""+m+"atc.fail."+c,1),X(C,D,J,!1),[2];case 4:f["default"].count(""+m+"atc.success."+c,1),L=null,A.label=5;case 5:return A.trys.push([5,7,,8]),[4,N.addTracking(e.getCartCount,{},t||"")()];case 6:return L=A.sent(),[3,8];case 7:return O=A.sent(),v.log("CerberusSharedCards.getCartCount."+O.toString()+"; asin: "+x,"ERROR"),
f["default"].count(""+m+"gcc.fail."+c,1),[2];case 8:return f["default"].count(""+m+"gcc.success."+c,1),X(C,D,J,!0),[4,Ia(L.items)];case 9:return A.sent(),G=I["default"].cardRoot.getElementsByClassName("_Y2VyY_idAddToCartClickedFlag_rhlYt"),0<G.length&&G[0].setAttribute("value","true"),[2]}})})})};try{for(var q=y.__values(a),k=q.next();!k.done;k=q.next()){var r=b(k.value);if("object"===typeof r)return r.value}}catch(p){var z={error:p}}finally{try{k&&!k.done&&(g=q.return)&&g.call(q)}finally{if(z)throw z.error;
}}},la=function(a,d,b,c,e,g){setTimeout(function(){N.addTracking(a.getAddToCartButton)(d).then(function(l){var m,n=[];try{for(var q=y.__values(b),k=q.next();!k.done;k=q.next()){var r=k.value;if(r.asin in l){var z=r.dataAttributes,p=r.cartActionContainerElement;n.push(y.__assign(y.__assign({},r),{dataAttributes:y.__assign(y.__assign({},z),{offerListingId:l[r.asin].offerListingId}),cartActionContainerElement:p}));if(p){p.style.display="block";var x=p.querySelector("button");x&&(x.textContent=l[r.asin].actionButtonText)}}}}catch(h){var w=
{error:h}}finally{try{k&&!k.done&&(m=q.return)&&m.call(q)}finally{if(w)throw w.error;}}Y(n,c,e,g,a)}).catch(function(l){v.log("CerberusSharedCards.ATC."+l,"ERROR")})},50)};M._operationNames=["addToCart","getCartCount","getPrimeBadge","getAddToCartButton","getKindleProgram"];M.card=function(){return y.__awaiter(void 0,void 0,void 0,function(){var a,d,b,c,e,g,l,m,n,q,k,r,z,p,x,w,h,t,u,C,D,J,F,K,L,O,G,A,ma,Z,na;return y.__generator(this,function(Pa){a=Date.now();d=!1;try{f["default"].count("prs.crb.clnt.eval.begin",
1);f["default"].uet("bb","cerberus-shared",S);b=za["default"].setup();try{c=La(I["default"].cardRoot.getElementsByClassName("_Y2VyY_idWidgetData_13wSW")[0])}catch(B){throw v.log("CerberusSharedCards.WidgetData."+B.message,"ERROR"),f["default"].count("rsi.gwdata.fail",1),f["default"].count("prs.crb.clnt.eval.fail.data-input",1),d=!0,B;}e=c.deviceType||"unknown";g=Ma(c.widgetType,c.widgetTypeVariant);l=Ja(e);m=c.renderPageType;f["default"].count(g.metrics.typeClientCounter,1);f["default"].count(g.metrics.typeVariantClientCounter,
1);f["default"].count(""+g.metrics.typeClientCounter+l.metrics.counterSuffix,1);f["default"].count(""+g.metrics.typeVariantClientCounter+l.metrics.counterSuffix,1);g.isOos?f["default"].count("prservices.ooswidget.shown."+e,1):g.isFod?f["default"].count("prservices.fodwidget.shown."+e,1):g.isCart?xa["default"].refreshAutoTruncate():"Odp"===c.widgetType&&f["default"].count("prservices.odpwidget.client.time",Date.now()-a);n=I["default"].cardRoot.getElementsByClassName("_Y2VyY_idAsinFaceoutContainer_1tA-V");
q=[];k=[];r=[];z=[];p=[];x=[];w=[];for(h=0;h<n.length;h++)t=n[h],u=Ka(t),C=u.asin,D=t.getElementsByClassName("_Y2VyY_idAsinFaceoutImageLink_2gOXw")[0],J=u.isPrimeBadgeLazyEnabled?t.getElementsByClassName("_Y2VyY_idAsinFaceoutLazyPrimeBadge_3MnZp")[0]:void 0,F={asin:C,cartActionContainerElement:t.getElementsByClassName("_Y2VyY_idAsinFaceoutCartActionContainer_2iTcx")[0],cartActionLazyLoadedContainerElement:t.getElementsByClassName("_Y2VyY_idAsinFaceoutCartActionLazyContainer_28Jkk")[0],containerElement:t,
dataAttributes:u,imageElement:null===D||void 0===D?void 0:D.getElementsByTagName("img")[0],imageLinkElement:D,lazyPrimeBadgeElement:J,titleLinkElement:t.getElementsByClassName("_Y2VyY_idAsinFaceoutTitleLink_3_7-h")[0]},q.push(F),J&&(r.push(C),k.push(F)),"Odp"===c.widgetType&&(w.push(C),x.push(F)),c.isLazyLoadedATCButtonEnabled&&F.cartActionLazyLoadedContainerElement&&(p.push(C),z.push(F));!c.isLazyPrimeBadgeEnabled&&k.length&&v.log("CerberusSharedCards.UnexpectedState.lazyPrimeBadges found when not enabled",
"ERROR");c.isLazyLoadedATCButtonEnabled||Y(q,c,g,e,b);f["default"].uet("cf","cerberus-shared",S);K=function(){f["default"].uet("be","cerberus-shared",S);Na(q,g,c);f["default"].uex("ld","cerberus-shared",S)};0<k.length?(L=N.addTracking(b.getPrimeBadge),L(r).then(function(B){var Q;try{for(var T=y.__values(k),R=T.next();!R.done;R=T.next()){var aa=R.value,ba=aa.asin,oa=aa.containerElement,ca=aa.lazyPrimeBadgeElement;ca?B[ba]?(ca.classList.remove("_Y2VyY_hidden_2mxOy"),oa.dataset.isPrime="true"):(ca.classList.add("_Y2VyY_hidden_2mxOy"),
oa.dataset.isPrime="false"):v.log("CerberusSharedCards.MissingElement.lazyPrimeBadge not found; asin: "+ba+"; isPrime: "+B[ba],"ERROR")}}catch(Oa){var pa={error:Oa}}finally{try{R&&!R.done&&(Q=T.return)&&Q.call(T)}finally{if(pa)throw pa.error;}}}).catch(function(B){v.log("CerberusSharedCards.getPrimeBadge failed: "+B,"ERROR")}).then(function(){return K()})):K();O=function(B){var Q=B.imageElement;Q?fa["default"].pageLoad.then(function(){return ya["default"].loadDynamicImage(Q)}):v.log("CerberusSharedCards.MissingElement.image not found; asin: "+
B.asin,"ERROR")};try{for(G=y.__values(q),A=G.next();!A.done;A=G.next())ma=A.value,O(ma)}catch(B){Z={error:B}}finally{try{A&&!A.done&&(na=G.return)&&na.call(G)}finally{if(Z)throw Z.error;}}Da();if(c.isBuyingRulesReminderCxEnabled||"Odp"===c.widgetType||c.isLazyLoadedATCButtonEnabled)f["default"].count("rsi.crb.brx.setup.init",1),fa["default"].pageReady.then(function(){"object"===typeof P?"dp"===m?P.when("dp-time-to-interactive").execute("cerberusSharedCardsBuyingRulesCxMarkerWait",function(B){B.getClickToCIPromise().then(function(){Fa();
Ga();Ha(c);c.isLazyLoadedATCButtonEnabled&&la(b,p,z,c,g,e)})}):v.log("Buying Rules CX loaded on non-DP page; renderPageType: "+c.renderPageType+"; displayReason: "+c.displayReason+"; reftag: "+c.reftag+";","FATAL"):v.log("P global not found when enabling Buying Rules CX; asin: "+c.pageAsin,"FATAL")});f["default"].count("prs.crb.clnt.eval.end",1)}catch(B){throw d||(v.log("Top level error in client.ts: "+B.message,"FATAL"),f["default"].count("prs.crb.clnt.eval.fail.unknown",1)),B;}return[2]})})};M.loadKindleProgramComponent=
function(a,d,b){N.addTracking(a.getKindleProgram)(d).then(function(c){var e;try{for(var g=y.__values(b),l=g.next();!l.done;l=g.next()){var m=l.value,n=m.asin,q=c[n].programType,k=m.containerElement.getElementsByClassName("_Y2VyY_idAsinFaceoutKU_3bhRe")[0],r=m.containerElement.getElementsByClassName("_Y2VyY_idAsinFaceoutKUHeadPhones_2TDZ3")[0],z=m.containerElement.getElementsByClassName("_Y2VyY_idAsinFaceoutKUPrime_1wZ2G")[0];if(q&&k&&r&&z){"kindle_unlimited"===q?(r.remove(),z.remove(),k.classList.remove("_Y2VyY_hidden_2mxOy"),
f["default"].count("prs.crb.odp.ku.rendered",1)):"kindle_unlimited_headphones"===q?(k.remove(),z.remove(),r.classList.remove("_Y2VyY_hidden_2mxOy"),f["default"].count("prs.crb.odp.kuh.rendered",1)):"kindle_unlimited_prime"===q&&(k.remove(),r.remove(),z.classList.remove("_Y2VyY_hidden_2mxOy"),f["default"].count("prs.crb.odp.kup.rendered",1));var p=c[n].shortMessage;if(p){var x=m.containerElement.getElementsByClassName("_Y2VyY_idAsinFaceoutPrice_3d8LX")[0],w=m.containerElement.getElementsByClassName("_Y2VyY_idAsinFaceoutKindleProgramShortMessage_1onH2")[0];
x&&w&&(x.remove(),w.textContent=p,w.classList.remove("_Y2VyY_hidden_2mxOy"))}}else v.log("CerberusSharedCards.getKindleProgram failed:  Unable to render kindle program. ASIN: "+n,"WARN")}}catch(t){var h={error:t}}finally{try{l&&!l.done&&(e=g.return)&&e.call(g)}finally{if(h)throw h.error;}}}).catch(function(c){v.log("CerberusSharedCards.getKindleProgram failed: "+c,"ERROR")})};M.setupCartAction=Y;M.setupLazyLoadedAddToCartButton=la});
